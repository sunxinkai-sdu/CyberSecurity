## Google Password Checkup验证
### 基于 DDH 的私密交集求和协议（DDH-based Private Intersection-Sum Protocol）
论文 https://eprint.iacr.org/2019/723.pdf的section 3.1 ，也即 Figure 2 中展示的协议,为基于 DDH 的私密交集求和协议（DDH-based Private Intersection-Sum Protocol），下面介绍协议目标、密码学基础、实现流程等内容。
#### 协议目标
该协议旨在私密地计算两个参与方集合的交集元素所对应的数值之和，在不泄露各自集合非交集部分信息的前提下完成：

参与方 P1 拥有集合 V = {v₁, ..., vₘ₁}（仅有标识符）。

参与方 P2 拥有集合 W = {(wᵢ, tᵢ)}（带有权重或数值的标识符对）。

最终，P2 仅获得集合交集中 tᵢ 的加总结果，且 P1 无法知道任何关于 P2 的数据，P2 也不能得知交集以外的元素。
#### 密码基础与工具
##### 群 G 与 Hash 函数 H
群 G 是一个素数阶群，支持安全的指数运算（例如椭圆曲线或 Zₚ*）。

Hash 函数 H : 𝕌 → G 将用户标识符映射到群元素中，用作一致性匹配，同时模拟随机预言机（Random Oracle）。
##### DDH 假设的作用
协议安全性依赖于 DDH（Decisional Diffie-Hellman）困难性，确保对于非交集项，无法通过三次指数值 H(v)^k₁^k₂ 恢复出原值或关联。
##### 加法同态加密（AHE）
使用如 Paillier 加密系统，支持：
AEnc(m₁) ⊕ AEnc(m₂) = AEnc(m₁ + m₂)

用于在不解密的情况下累加多个密文 tᵢ。
#### 输入
##### P1 的输入：
一个标识符集合 V = {v₁, v₂, ..., vₘ₁}，每个 vᵢ ∈ 𝕌
##### P2 的输入：
一组键值对 W = {(wᵢ, tᵢ)}, 每个 wᵢ ∈ 𝕌, tᵢ ∈ ℤ⁺，带有附加值（例如金额、分数等）
#### 协议执行流程
##### Setup 阶段：
P1 和 P2 各自选择私钥指数 k₁, k₂。

P2 生成加法同态加密的公钥 pk，私钥 sk。
##### Round 1（由 P1 发起）：
对每个 vᵢ ∈ V，P1 计算 H(vᵢ)^k₁。

将所有 {H(vᵢ)^k₁} 打乱顺序后发送给 P2。
##### Round 2（由 P2 进行处理）：
对收到的 H(vᵢ)^k₁，P2 再次指数化为 H(vᵢ)^{k₁k₂}。

打乱后记为 Z，待会儿用于 P1 做匹配。

对自己的每对 (wⱼ, tⱼ)：

计算 H(wⱼ)^k₂

使用 pk 加密 tⱼ，即 AEnc(tⱼ)

构成对：(H(wⱼ)^k₂, AEnc(tⱼ))

将这些对打乱顺序后发送给 P1。
##### Round 3（由 P1 处理）：
对收到的 (H(wⱼ)^k₂, AEnc(tⱼ))，P1 再指数化：

得到 H(wⱼ)^{k₁k₂}。

与 Round 1 中被发送的 {H(vᵢ)^{k₁k₂}} 集合做匹配，识别交集索引集合 J。

将交集对应的密文 AEnc(tⱼ) 做加法同态加法，得到总和密文：

AEnc(SJ)=AEnc（∑tj） 

使用加密系统的刷新算法 ARefresh 对密文重新随机化后，发回 P2。
##### Output 阶段（由 P2 解密）：
P2 使用私钥 sk 解密最终密文，获得：

𝑆𝐽=∑t𝑗

即交集中 tⱼ 值的总和。
#### 隐私保证分析
##### 对 P1 的隐私保护：
P2 无法得知 V 中具体哪些元素与 W 匹配。

所有元素都是指数化后的随机群元素，且乱序发送。
##### 对 P2 的隐私保护：
P1 只能看到加密的 tⱼ，且无解密能力。

非交集部分的 tⱼ 不会被用到累加中。
##### 总体隐私：
协议只泄露交集大小和交集 tⱼ 的总和，而不暴露交集中具体的元素。
#### 实验结果
详细请见project6.png
#### 实验总结
该协议实现了在隐私保护前提下的“集合交集求和”功能，适用于多种场景，安全基础扎实。
